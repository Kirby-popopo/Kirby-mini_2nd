<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Clone - Dark Mode</title>
    <!-- ì‚¬ì´ë“œë°” css -->
    <link rel="stylesheet" href="/sidebar/sidebar.css">
    <!-- ë©”ë‰´ css -->
    <link rel="stylesheet" href="/sidebar/menu.css">
    <!-- ê³µí†µ ë² ì´ìŠ¤ css -->
    <link rel="stylesheet" href="/base/base.css">

    <!-- mainPage css -->
    <link rel="stylesheet" href="/mainPage/mainPage.css">

</head>
<body>
<!--<h1>Welcome, <span th:text="${User.name}">User</span></h1>-->

    <!-- sidebar html ë¶ˆëŸ¬ì˜¤ê¸° -->
    <div id="sidebar-container"></div>

    <script>
        fetch('/sidebar/sidebar.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('sidebar-container').innerHTML = data;
            })
            .catch(error => console.error('Error loading sidebar:', error));
    </script>
    <!-- sidebar html ë¶ˆëŸ¬ì˜¤ê¸° ë -->
<div class="container">
    <div class="main-content">
        <div class="post">
            <div class="post-header">
                <img src="https://media.istockphoto.com/id/466167557/ko/%EC%82%AC%EC%A7%84/%EC%8B%A0%EC%83%9D%EC%95%84-chick.jpg?s=612x612&w=0&k=20&c=94vZS_L2t47Yb1DtHTYv1VBjVP6Ecu_SgmH79aCfEfE=" alt="ë³‘ì•„ë¦¬ í”„ë¡œí•„">
                <span class="username">ë³‘ì•„ë¦¬</span>
            </div>
            <div class="post-image">
                <img src="https://img.freepik.com/premium-photo/fried-rice-with-fried-egg-delicious-food-photography-illustration-created-with-generative-ai_115122-6028.jpg" alt="ê³„ë€í”„ë¼ì´">
            </div>
            <div class="post-actions">
                <button>â¤ï¸</button>
                <button>ğŸ’¬</button>
                <button>ğŸ”–</button>
            </div>
            <div class="post-likes">
                ë±€ë‹˜ ì™¸ 2ëª…ì´ ì¢‹ì•„í•©ë‹ˆë‹¤
            </div>
            <div class="post-content">
                <span class="username">ë³‘ì•„ë¦¬</span>
                <span class="content">2024-10-02</span>
                <span class="content" id="full-content" style="display: none;">ê°“ìƒì‚´ì<br>#ì•„ì¹¨ #ë§›ìˆë‹¤</span>
                <span class="more" id="show-more" onclick="toggleContent()">ë” ë³´ê¸°</span>
            </div>
            <div class="post-comments">
                <p>ëŒ“ê¸€ 2ê°œ</p>
                <div id="comments" style="display: none;">
                    <p><span class="username">ë±€</span> ë§›ìˆê² ë‹¤ :)</p>
                    <p><span class="username">ì‚¬ì</span> @í˜¸ë‘ì´ ê°“ìƒ ê°€ë³´ìê³ </p>
                </div>
                <span class="more" id="show-comments" onclick="toggleComments()">ëŒ“ê¸€ ëª¨ë‘ ë³´ê¸°</span>
            </div>
                <div class="comment-input">
                    <input type="text" placeholder="ëŒ“ê¸€ ë‹¬ê¸°...">
                </div>
            </div>
        </div>
    </div>

<!-- í•´ë‹¹ ë¶€ë¶„ë¶€í„° ê²Œì‹œê¸€ ê°€ì ¸ì˜¤ëŠ” ë¶€ë¶„ ë -->

<!-- ê²Œì‹œê¸€ ì…ë ¥ í•˜ëŠ” ë¶€ë¶„ -->

<div id="createPostModal" class="modal">
    <div class="modal-content">
        <form method="post" action="/posts">
            <h2>ìƒˆ ê²Œì‹œë¬¼ ë§Œë“¤ê¸°</h2>
            <button type="button" id="backButton" onclick="goBack()" style="display: none;">â†</button>
            <div class="post-image">
                <img id="selectedImagePreview" src="" alt="ì„ íƒí•œ ì´ë¯¸ì§€" style="display: none;">
            </div>
            <input type="file" id="fileInput" onchange="convertToBase64(event)">
            <input type="hidden" id="base64Image" name="base64Image">
            <textarea name="content_box" maxlength="2200" placeholder="ê²Œì‹œê¸€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            <input type="submit" value="ê³µìœ í•˜ê¸°">
            <a herf="/mainPage">ì·¨ì†Œ</a>
        </form>
    </div>
</div>
<!-- ê²Œì‹œê¸€ ì…ë ¥ í•˜ëŠ” ë¶€ë¶„ ë -->
<!--ê²Œì‹œê¸€ ì…ë ¥ í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸ + íŒì—…ì°½ ë„ìš°ê¸° (ì‘ì„±í•œ ê²Œì‹œê¸€ ë¯¸ë¦¬ë³´ê¸°)-->


<!-- ê²€ìƒ‰, ì•Œë¦¼ ê¸°ëŠ¥ ì‚¬ì´ë“œë°” -->

<div id="menu-container"></div>
<script>
    fetch('/sidebar/menu.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('menu-container').innerHTML = data;

             var createPostButton = document.getElementById("createPost");
        var modal = document.getElementById("createPostModal");

        if (createPostButton) {
            createPostButton.addEventListener('click', function(event) {
                console.log("test");
                modal.style.display = "block"; // ê²Œì‹œê¸€ ì‘ì„± ëª¨ë‹¬ì„ ì—´ê¸°
            });
        }

   window.onclick = function(event) {
       if (event.target == modal) {
           modal.style.display = "none"; // ëª¨ë‹¬ ì™¸ë¶€ë¥¼ í´ë¦­í•˜ë©´ ëª¨ë‹¬ ë‹«ê¸°
       }
   }
        })
        .catch(error => console.error('Error loading menu:', error));
</script>

<script src="/sidebar/menu.js" type="text/javascript"></script>
<!-- ê²€ìƒ‰, ì•Œë¦¼ ê¸°ëŠ¥ ì‚¬ì´ë“œë°” ë-->

<script>
    // ê²Œì‹œê¸€ ì»¨í…ì¸  í† ê¸€ê´€ë ¨
   function toggleContent() {
       var fullContent = document.getElementById("full-content");
       var showMore = document.getElementById("show-more");
       if (fullContent.style.display === "none") {
           fullContent.style.display = "inline";
           showMore.textContent = "ìˆ¨ê¸°ê¸°";
       } else {
           fullContent.style.display = "none";
           showMore.textContent = "ë” ë³´ê¸°";
       }
   }

   function toggleComments() {
       var comments = document.getElementById("comments");
       var showComments = document.getElementById("show-comments");
       if (comments.style.display === "none") {
           comments.style.display = "block";
           showComments.textContent = "ëŒ“ê¸€ ìˆ¨ê¸°ê¸°";
       } else {
           comments.style.display = "none";
           showComments.textContent = "ëŒ“ê¸€ ëª¨ë‘ ë³´ê¸°";
       }
   }

   var profileButton = document.getElementById("profile");
   profileButton.addEventListener('click', function(event){

        window.location.href = "/test";
   });

   // íŒŒì¼ ì„ íƒ í›„ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ë° Base64 ì¸ì½”ë”© ì²˜ë¦¬
   function convertToBase64(event) {
       var reader = new FileReader();
       reader.onload = function() {
           var output = document.getElementById('selectedImagePreview');
           output.src = reader.result;
           output.style.display = "block"; // ì„ íƒí•œ ì´ë¯¸ì§€ë¥¼ í‘œì‹œ

           // Base64 ì¸ì½”ë”©ëœ ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ìˆ¨ê²¨ì§„ í•„ë“œì— ì €ì¥
           document.getElementById('base64Image').value = reader.result;

           // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ë„ ì´ë¯¸ì§€ ì„ íƒ í›„ì—ë§Œ í‘œì‹œ
           document.getElementById('backButton').style.display = "block";
       };
       reader.readAsDataURL(event.target.files[0]);
   }

   function goBack() {
       document.getElementById('selectedImagePreview').style.display = "none"; // ì„ íƒí•œ ì´ë¯¸ì§€ ìˆ¨ê¸°ê¸°
       document.getElementById('fileInput').value = ""; // íŒŒì¼ ì…ë ¥ ì´ˆê¸°í™”
       document.querySelector('textarea[name="content_box"]').style.display = "none"; // í…ìŠ¤íŠ¸ ë°•ìŠ¤ ìˆ¨ê¸°ê¸°
       document.getElementById('backButton').style.display = "none"; // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ìˆ¨ê¸°ê¸°
   }
</script>

<!-- ë¸Œë¼ìš°ì € ë¹„ìœ¨ì— ë”°ë¥¸ ì‚¬ì´ë“œë°” ìˆ¨ê¹€ ê¸°ëŠ¥ -->
<script>
    // JavaScript for responsive sidebar
    function handleResize() {
        const sidebar = document.querySelector('.sidebar');
        if (window.innerWidth <= 768) {
            sidebar.style.display = 'none';
        } else {
            sidebar.style.display = 'block';
        }
    }

    window.addEventListener('resize', handleResize);
    handleResize(); // Call once to set initial state
</script>
</body>
</html>
